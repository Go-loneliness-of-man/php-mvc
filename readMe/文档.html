<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <title></title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="ls.css">
  <style>

  </style>
</head>

<body>
  <div id="h1"><span class="smallh1">rw 文档</span></div>
  <div id="body">
    <details>
      <summary>前言</summary>
      <span class="em">声明</span>：
      <p>
        本框架由 <a target = "_blank" href="https://github.com/Go-loneliness-of-man">goLone</a> 个人开发，<span class="em">仅供新手学习交流使用</span>，
        相比成熟框架尚存在诸多缺陷，请勿用作商业用途，如若造成损失，概不负责 ╮(￣▽￣)╭
      </p>
      <span class="em">框架简介</span>：
      <p>
        rw 适合供新手学习使用，我做它的动力主要来源于兴趣，用别人的框架总有点不舒服，就想自己做个框架玩玩，之所以说它适合新手学习是因为<span class="em">它的源码注释详尽，
        逻辑易懂</span>（至少我自己是这样认为的 ^_^），rw 的<span class="em">大部分功能是我模仿自己用过的几个框架的创意</span>，但 99% 的代码实现均为原创（.htaccess 文件我直接拿了
        tp5 的），模仿的只有创意，实现思路是我自己的，当然我也加了一些自己的创意，比如公共控制器的 sql 构造器。这是我第一次写框架，肯定存在诸多不足，欢迎有想法的小伙伴提出改进意见，
        互相交流学习。
      </p>
      <span class="em">新手指引</span>：
      <p>
        rw 基于 MVC 开发，但在 MVC 的基础上进行了一些拓展，目前拓展的部分包括 service、middleware，以下两张流程图分别表示了基本的 MVC 运行流程、rw 的运行流程：
      </p>
      <img src="MVC 框架基本运行流程.png">
      <img src="RW 运行流程.png">
      <p>
        rw 注释详尽，<span class="em">建议对面向对象比较了解的同学学会基本使用后，直接看源码</span>。
      </p>
      <span class="em">框架约定</span>：
      <p>
        rw 的使用非常自由，需要注意的只有以下几条：
      </p>
      <ol>
        <li>命名空间与路径一致</li>
        <li>除常量外，文件、类、命名空间统一采用小驼峰</li>
        <li>所有类文件的文件名与类名相同，并且一个类文件只放一个类</li>
        <li>数据表命名方式默认小写下划线，若不想这样做可以通过配置修改</li>
      </ol>
    </details>

    <details>
      <summary>目录结构</summary>
      <code>
          ├─app                                 // 应用目录
          │  ├─config                           // 全局配置文件目录
          │  │     ├─config.php                 // 全局配置文件
          │  │     └─route.php                  // 路由配置文件
          │  │
          │  ├─index                            // 模块目录
          │  │     ├─config.php                 // 模块配置文件
          │  │     │
          │  │     ├─controller                 // 模块控制器目录
          │  │     │  └─index.php               // 控制器 index
          │  │     │
          │  │     ├─model                      // 模块模型目录
          │  │     ├─service                    // 模块服务目录
          │  │     └─view                       // 模块视图目录
          │  │
          │  ├─middleware                       // 中间件目录
          │  │     └─test.php                   // 示例，可删
          │  │
          │  └─publicFunc                       // 公共函数目录
          │        └─public.php                 // 公共函数文件，可以有很多个
          │
          ├─core                                // 框架核心目录
          │  ├─app.php                          // 初始化文件
          │  ├─dao.php                          // dao，数据库访问对象的类
          │  ├─publicController.php             // 公共控制器类
          │  ├─publicModel.php                  // 公共模型类
          │  ├─publicService.php                // 公共服务类
          │  └─route.php                        // 路由类
          │
          ├─plugIn                              // 插件目录
          ├─public                              // 外部访问目录
          │  ├─.htaccess                        // 分布式配置文件，用于配置 url 转发
          │  └─index.php                        // 入口文件
          │
          └─readMe                              // 文档目录
             ├─ls.css                           // 文档样式
             ├─MVC 框架基本运行流程.png
             ├─php-mvc 运行流程.png
             ├─php-mvc 运行流程.xmind
             ├─开发笔记.html
             └─文档.html                        // 框架文档
      </code>
      <span class="em"></span>：
      <p>

      </p>
      <span class="em"></span>：
      <p>

      </p>
    </details>

    <details>
      <summary>路由</summary>
      <p>
        路径：/app/config/route.php
      </p>
      <p>
        默认路由与 ThinkPHP 相同：<span class="em">http://域名/模块/控制器/操作</span>
      </p>
      <p>
        支持路由注册，支持 params 传参，路由注册写法如下：
      </p>
      <code>
        $route = [
          ['路由路径', '模块名', '控制器名', '操作名'],
          ['路由路径/:参数 1 名/:参数 2 名/:参数 3 名', '模块名', '控制器名', '操作名']     // params 传参
        ];
      </code>
    </details>

    <details>
      <summary>控制器</summary>
      <p>
        路径：/app/模块名/controller/控制器名.php
      </p>
      <p>
        一个控制器的一般写法应是：
      </p>
      <code>
        &lt;?php
          namespace app\模块名\controller;                          // 命名空间，与文件路径保持一致
          use \core\publicController;                               // 引用公共控制器

          class index extends publicController {                    // 继承公共控制器

            public function 操作名() {
              函数体;
              return 结果;
            }
          }
      </code>
      <p>
        控制器一般包含参数过滤、调用 service、渲染视图等操作，因此我为公共控制器实现了以下方法：
      </p>

      <span class="em">get($isJson = 0, $convert = 1)</span>：
      <p>
        封装 $_REQUEST，栗子：$var = $this->get();
      </p>
      <ol>
        <li><span class="em">$isJson</span>，是否作为 json 进行转换，若是 1 将请求参数作为 json 进行转换，默认 0。</li>
        <li><span class="em">$convert</span>，是否进行类型转换，若是 1 将仅包含数字的字符串转换为 integer，默认为 1，若 $isJson 为 1 则不转换。</li>
      </ol>

      <span class="em">jump($msg, $m = M, $c = C, $a = A, $time = 5, $params = [])</span>：
      <p>
        路由跳转，只支持在项目内跳转。
      </p>
      <ol>
        <li><span class="em">$msg</span>，跳转前输出的消息。</li>
        <li><span class="em">$m</span>，跳转到的模块，默认 index 模块。</li>
        <li><span class="em">$c</span>，跳转到的控制器，默认 index 控制器。</li>
        <li><span class="em">$a</span>，跳转到的操作，默认 index 操作。</li>
        <li><span class="em">$time</span>，延时跳转，默认 5 秒。</li>
        <li><span class="em">$params</span>，传递的参数，默认为 []，会被转换为 json 加到 url 末尾的查询字符串，key 为 params。</li>
      </ol>

      <span class="em">rule($rule, $params)</span>：
      <p>
        参数校验，若不通过则停止执行并抛出错误信息。栗子：$this->rule(['a' => 'string', 'b' => 'integer', 'c' => 'integer'], $被校验的参数);
      </p>
      <ol>
        <li><span class="em">$rule</span>，用于定义校验规则，一维数组，key 为参数名，val 为参数类型。</li>
        <li><span class="em">$params</span>，被校验的参数。</li>
      </ol>
      <p>
        $rule 的 val 可以是以下类型：
      </p>
      <ol>
        <li><span class="em">boolean</span></li>
        <li><span class="em">integer</span></li>
        <li><span class="em">double</span></li>
        <li><span class="em">string</span></li>
        <li><span class="em">array</span></li>
        <li><span class="em">object</span></li>
        <li><span class="em">NULL</span></li>
      </ol>

      <span class="em"></span>：
      <p>

      </p>
      <ol>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
      </ol>

      <span class="em"></span>：
      <p>

      </p>
      <ol>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
      </ol>

      <span class="em"></span>：
      <p>

      </p>
      <ol>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
      </ol>
    </details>

    <details>
      <summary>服务</summary>
      <span class="em"></span>：
      <p>

      </p>
      <span class="em"></span>：
      <p>

      </p>
      <span class="em"></span>：
      <p>

      </p>
    </details>

    <details>
      <summary>模型</summary>
      <p>
        路径：/app/模块名/model/数据表的小驼峰形式.php
      </p>
      <p>
        一个控制器的一般写法应是：
      </p>
      <code>
        &lt;?php
        namespace app\模块名\model;                             // 命名空间，与文件路径保持一致
        use app\core\publicModel;                               // 引用公共模型

        class 模型名 extends publicModel {                      // 继承公共模型

            public function test() {

            }
        }
      </code>
      <p>
        如果你需要经常在某个数据表上进行一些重复操作，就可以使用 model 对其进行封装，model 是个类，负责与数据表一一映射。
      </p>
      <span class="em">表名、数据库名</span>：
      <p>
        model 会自动映射到与其类名（小驼峰）的小写下划线形式所对应的数据表，<span class="em">例如 demoName 会自动映射到数据表 demo_name</span>（如果你配置过
        $config['database']['front']、$config['database']['behind']，则会自动加上前、后缀），如果想自定义表名，直接在 model 类上覆盖 table 属性即可。数据库名会默认读取
        $config['database']['dbname']，若想自定义，同样直接在 model 类上覆盖 dbname 属性即可。
      </p>
      <span class="em"></span>：
      <p>

      </p>
      <span class="em"></span>：
      <p>

      </p>
    </details>

    <details>
      <summary>配置文件</summary>
      <p>
        支持<span class="em">全局配置文件、模块配置文件</span>。
      </p>
      <span class="em">全局配置文件</span>：
      <p>
        路径：/app/config/config.php
      </p>
      <p>
        作用于整个应用，包含如下配置项：
      </p>
      <ol>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
        <li><span class="em"></span>，。</li>
      </ol>
      <span class="em">模块配置文件</span>：
      <p>
        路径：/app/模块名/config.php
      </p>
      <p>
        用于为模块进行个性化配置，该文件会覆盖全局配置的参数，配置项与全局配置文件相同，格式如下：
      </p>
      <code>
          &lt;?php

          $模块名 = [                               // 配置变量名与模块名保持一致

          ];
      </code>
    </details>

    <details>
      <summary>DAO</summary>
      <p>
        dao 是个类，应用了单例模式，<span class="em">分为静态方法和属性、普通方法和属性两部分</span>，静态方法和属性实现了 sql 构造器，普通方法和属性用于原生查询。普通方法和属性如下：
      </p>
      <span class="em"></span>：
      <p>

      </p>
      <span class="em"></span>：
      <p>

      </p>
      <span class="em">sql 构造器</span>：
      <p>
        sql 构造器是我自己的创意，从过去的使用经验看，相比框架封装好的 api，我总是更倾向于写原生 sql，但原生 sql 写起来又稍有些麻烦，便封装了 sql 构造器这么个东西用于生成 sql。包含以下几个方法
      </p>
      <span class="em"></span>：
      <p>

      </p>
      <span class="em"></span>：
      <p>

      </p>
    </details>

    <details>
      <summary>公共函数</summary>
      <p>
        支持<span class="em">全局公共函数、模块公共函数</span>，需在 config 文件（全局、模块都可以）内配置，将文件名加入 'publicFuncFile' 即可。
      </p>
      <span class="em">全局公共函数</span>：
      <p>
        路径：/app/publicFunc/文件名
      </p>
      <p>
        作用于整个应用。
      </p>
      <span class="em">模块公共函数</span>：
      <p>
        路径：/app/模块名/文件名
      </p>
      <p>
        只在当前模块内生效，<span class="em">若与全局公共函数文件同名，会覆盖掉全局公共函数文件</span>。
      </p>
    </details>

    <details>
      <summary>中间件</summary>
      <p>
        路径：/app/middleware/文件名
      </p>
      <p>
        <span class="em">中间件是个类文件，可以存在多个中间件</span>。中间件必须在 config 文件（全局、模块都可以）的 'middleware' 中进行配置才能生效，写法如下：
      </p>
      <code>
        'middleware' => [
          ['中间件名', '被执行的方法名']
        ]
      </code>
      <p>
        中间件的执行顺序与在数组中的顺序相同，中间件不会被实例化，所以其<span class="em">方法必须是静态方法</span>，被默认传入 $_REQUEST 作为第一个参数。
      </p>
    </details>

    <details>
      <summary>挂载插件</summary>
      <p>
        路径：/plugIn/文件名
      </p>
      <p>
        插件应该是一个或多个类文件，统一放在 plugIn 目录下，使用时框架会自动加载其类文件。
      </p>
    </details>
  </div>
</body>

</html>